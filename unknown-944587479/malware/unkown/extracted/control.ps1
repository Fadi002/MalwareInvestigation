$lockFilePath = "C:\ProgramData\app.lock"
$timeout = 60
$startTime = Get-Date
while ($true) {
    Start-Sleep -Seconds 15
    if (-not (Get-Process -Id 9856 -ErrorAction SilentlyContinue)) {
        if (Test-Path $lockFilePath) {
            Remove-Item -Path $lockFilePath -Force
        }
        exit
    }
    $elapsedTime = (Get-Date) - $startTime
    if ($elapsedTime.TotalSeconds -gt $timeout) {
        if (Test-Path $lockFilePath) {
            Remove-Item -Path $lockFilePath -Force
        }
        exit
    }
}